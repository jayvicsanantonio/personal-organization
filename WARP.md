# WARP.md

This file provides guidance to WARP (warp.dev) when working with code in this repository.

Repository focus: personal macOS organization, repeatable system setup, and Git security automation. Everything lives at the repo root for easy auditing.

Common commands (run from repo root)

- Recreate tooling baseline via Homebrew Bundle
  - Install all listed CLI apps, GUI apps, and VS Code extensions
    ```sh
    brew bundle install --file=Brewfile
    ```
  - Verify what would be installed without changing the system
    ```sh
    brew bundle check --file=Brewfile
    ```
  - Refresh Brewfile from current machine (overwrites Brewfile)
    ```sh
    brew bundle dump --force
    ```

- macOS configuration (defaults)
  - Apply saved system preferences to a new machine
    ```sh
    ./defaults_settings.sh
    ```
  - Export current machine’s preferences to regenerate defaults_settings.sh
    ```sh
    ./export_defaults.sh
    ```
  - Note: defaults_settings.sh is generated; prefer updating it via export_defaults.sh and reviewing diffs before committing.

- Git security tooling
  - One-time global setup (git-secrets + pre-commit templates, global .gitignore, helper scripts)
    ```sh
    ./setup-git-hooks.sh
    ```
  - Apply hooks to an existing repository
    ```sh
    ./apply-git-hooks.sh /absolute/path/to/repository
    ```
  - Scan a repository’s history for secrets
    ```sh
    ./scan-repo-for-secrets.sh /absolute/path/to/repository
    ```

- AI assistant rules symlinks (optional, per editor/tool)
  - The canonical rules file is .rules. Create editor-specific symlinks as needed:
    ```sh
    ln -sf .rules .windsurfrules
    ln -sf .rules .clinerules
    ln -sf .rules .cursorrules
    ```

High-level architecture and structure

- Documentation nucleus
  - README.md: purpose, contents, and how the pieces fit together.
  - brewfile.md: how to use Brewfile, prerequisites, and examples.
  - macos_defaults.md: what defaults cover (Dock, Finder, Desktop Services) and how to apply/export.
  - git-security.md: layers of protection (git-secrets, pre-commit), global config locations, and usage of helper scripts.
  - BOOKMARKS.md and bookmarks.html: taxonomy and importable bookmark export.
  - keyboard_shortcuts.md: personal productivity shortcuts across macOS, Raycast, VS Code, Chrome DevTools, and Warp.

- Automation entrypoints (shell scripts)
  - setup-git-hooks.sh: installs/ensures git-secrets and pre-commit, configures global templates, sets up global .gitignore, and generates helper scripts.
  - apply-git-hooks.sh: installs hooks into an existing repo; intended for repos created before global templates.
  - scan-repo-for-secrets.sh: runs git secrets --scan-history on a target repo.
  - export_defaults.sh: reads selected preference domains and writes a reproducible defaults_settings.sh. This is the source of truth for regenerating macOS settings.
  - defaults_settings.sh: generated script that applies Dock/Finder/Desktop Services preferences and restarts affected services. Treat as generated output and review diffs when it changes.

- Configuration manifests
  - Brewfile: declarative list of CLI tools (brew), GUI apps (cask), and VS Code extensions (vscode) for new-machine bootstrap.
  - windsuf.settings.json: editor settings (formatting, validation, search excludes) and MCP server input definitions. Informational for editors; not consumed by CLI.
  - .rules: central AI assistant operating guidelines. Other tools may symlink to it for compatibility.

- Guidance files for AI agents
  - CLAUDE.md: summarizes the repo, calls out key commands (git security ops, macOS config, brew bundle), and highlights architecture (rules file, security framework, configuration management).
  - AGENTS.md: practical conventions for where things live (root-level scripts and docs), how to run/setup (brew bundle, setup-git-hooks.sh, export_defaults.sh), and lightweight validation (e.g., shellcheck if available, brew bundle check, and secrets scans before publishing).

Operating assumptions and conventions

- macOS + zsh environment; scripts use zsh or bash shebangs as appropriate.
- Security posture centers on preventing secret leakage and enabling retroactive audits:
  - Global git template for auto-installed hooks in new repos.
  - Helper scripts to retrofit security into existing repos and to scan history.
- Configuration management favors reproducibility:
  - Brewfile is the authoritative list of software.
  - defaults_settings.sh is generated by export_defaults.sh; don’t hand-edit—regenerate and review diffs.

Testing, linting, and verification

- There is no formal test suite in this repository. Validate changes by:
  - Re-running the touched scripts and confirming clean exits.
  - Running brew bundle check --file=Brewfile after modifying Brewfile.
  - Re-exporting defaults via ./export_defaults.sh and reviewing the generated diff to ensure only intended keys changed.
  - Optionally linting shell changes with shellcheck if available on the system.

Quick reference

- Fresh machine baseline: brew bundle install --file=Brewfile
- Apply macOS preferences: ./defaults_settings.sh
- Regenerate macOS preferences script: ./export_defaults.sh
- Global security setup: ./setup-git-hooks.sh
- Retrofit hooks to a repo: ./apply-git-hooks.sh /path/to/repo
- Audit repo history for secrets: ./scan-repo-for-secrets.sh /path/to/repo
- Point AI tools at canonical rules: ln -sf .rules .windsurfrules (and similar for other tools)
